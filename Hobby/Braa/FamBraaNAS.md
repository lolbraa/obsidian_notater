WD Mycloud EX4
Serienummer 	WUL242402327
# Array
## Pre Okt. 2024
Se [[#Recovery 09.10.2024]].

|                 | DISK1                | DISK2 ØDELAGT        | DISK3                | DISK4                |
| --------------- | -------------------- | -------------------- | -------------------- | -------------------- |
| Leverandør      | WD                   | WD                   | WD                   | WD                   |
| Modell          | WDC WD30EFRX-68EUZN0 | WDC WD30EFRX-68EUZN0 | WDC WD30EFRX-68EUZN0 | WDC WD30EFRX-68EUZN0 |
| Serienummer     | WD-WCC4N5KCFEZ0      | WD-WMC4N1179960      | WD-WMC4N1142831      | WD-WMC4N1137792      |
| Kapasitet       | 3 TB                 | 3 TB                 | 3 TB                 | 3 TB                 |
| Fastvareversjon | 82.00A82             |                      | 80.00A80             | 80.00A80             |
## Okt. 2024
|                 | Tray 1               | Tray 2               | Tray 3               | Tray 4               | Spare                |
| --------------- | -------------------- | -------------------- | -------------------- | -------------------- | -------------------- |
| "Navn"          | DISK1                | DISK5                | DISK3                | DISK4                |                      |
| Leverandør      | WD                   | Seagate              | WD                   | WD                   | Seagate              |
| Modell          | WDC WD30EFRX-68EUZN0 | ST12000NM000J-2TY103 | WDC WD30EFRX-68EUZN0 | WDC WD30EFRX-68EUZN0 | ST12000NM000J-2TY103 |
| Serienummer     | WD-WCC4N5KCFEZ0      | ZRT1EV1Y             | WD-WMC4N1142831      | WD-WMC4N1137792      | ZRT1CT56             |
| Kapasitet       | 3 TB                 | 12 TB                | 3 TB                 | 3 TB                 | 12 TB                |
| Fastvareversjon | 82.00A82             | SN04                 | 80.00A80             | 80.00A80             | SN04                 |




# Folder structures
- [ ] Backup
	- [ ] FlyttetTilNCGNAS
	- [ ] Karoline 
	- [ ] Martin
	- [ ] NCPterodactyl
	- [ ] Server host
	- [ ] Nettverkskart.txt
- [ ] Fam_Braa
	- [ ] Fotobank
	- [ ] KristofferKryptertHvelv
	- [ ] Regnskap
	- [ ] Stig Minnepenn
- [ ] ~~Kristoffer~~
	- [ ] ~~Lolbraa Fotogenitet....~~
- [ ] ~~Public~~
	- [ ] ~~automaticrippingmachine~~
	- [ ] ~~photoframe~~
	- [ ] ~~Shared ...~~


# SMART
## DISK1

| DISK1 |                         | Gjeldende | Verste | Terskel |
| ----- | ----------------------- | --------- | ------ | ------- |
| 1     | Raw_Read_Error_Rate     | 200       | 200    | 51      |
| 3     | Spin_Up_Time            | 180       | 174    | 21      |
| 4     | Start_Stop_Count        | 73        | 73     | 0       |
| 5     | Reallocated_Sector_Ct   | 200       | 200    | 140     |
| 7     | Seek_Error_Rate         | 100       | 253    | 0       |
| 9     | Power_On_Hours          | 40        | 40     | 0       |
| 10    | Spin_Retry_Count        | 100       | 100    | 0       |
| 11    | Calibration_Retry_Count | 100       | 100    | 0       |
| 12    | Power_Cycle_Count       | 100       | 100    | 0       |
| 192   | Power-Off_Retract_Count | 200       | 200    | 0       |
| 193   | Load_Cycle_Count        | 191       | 191    | 0       |
| 194   | Temperature_Celsius     | 120       | 96     | 0       |
| 196   | Reallocated_Event_Count | 200       | 200    | 0       |
| 197   | Current_Pending_Sector  | 200       | 200    | 0       |
| 198   | Offline_Uncorrectable   | 100       | 253    | 0       |
| 199   | UDMA_CRC_Error_Count    | 200       | 200    | 0       |
| 200   | Multi_Zone_Error_Rate   | 200       | 200    | 0       |

## DISK3

|   |   |   |   |   |
|---|---|---|---|---|
|1|Raw_Read_Error_Rate|200|200|51|
|3|Spin_Up_Time|177|169|21|
|4|Start_Stop_Count|63|63|0|
|5|Reallocated_Sector_Ct|200|200|140|
|7|Seek_Error_Rate|100|253|0|
|9|Power_On_Hours|27|27|0|
|10|Spin_Retry_Count|100|100|0|
|11|Calibration_Retry_Count|100|100|0|
|12|Power_Cycle_Count|100|100|0|
|192|Power-Off_Retract_Count|200|200|0|
|193|Load_Cycle_Count|7|7|0|
|194|Temperature_Celsius|119|94|0|
|196|Reallocated_Event_Count|200|200|0|
|197|Current_Pending_Sector|200|200|0|
|198|Offline_Uncorrectable|100|253|0|
|199|UDMA_CRC_Error_Count|200|200|0|
|200|Multi_Zone_Error_Rate|200|200|0|


## DISK4   

|     |                         |     |     |     |
| --- | ----------------------- | --- | --- | --- |
| 1   | Raw_Read_Error_Rate     | 200 | 200 | 51  |
| 3   | Spin_Up_Time            | 180 | 175 | 21  |
| 4   | Start_Stop_Count        | 63  | 63  | 0   |
| 5   | Reallocated_Sector_Ct   | 200 | 200 | 140 |
| 7   | Seek_Error_Rate         | 100 | 253 | 0   |
| 9   | Power_On_Hours          | 28  | 28  | 0   |
| 10  | Spin_Retry_Count        | 100 | 100 | 0   |
| 11  | Calibration_Retry_Count | 100 | 100 | 0   |
| 12  | Power_Cycle_Count       | 100 | 100 | 0   |
| 192 | Power-Off_Retract_Count | 200 | 200 | 0   |
| 193 | Load_Cycle_Count        | 8   | 8   | 0   |
| 194 | Temperature_Celsius     | 120 | 94  | 0   |
| 196 | Reallocated_Event_Count | 200 | 200 | 0   |
| 197 | Current_Pending_Sector  | 200 | 200 | 0   |
| 198 | Offline_Uncorrectable   | 100 | 253 | 0   |
| 199 | UDMA_CRC_Error_Count    | 200 | 200 | 0   |
| 200 | Multi_Zone_Error_Rate   | 200 | 200 | 0   |

## DISK5
Før prestress-test [[ST12000NM000J-2TY103-ZRT1EV1Y-SMART_mht.txt]]

| ID  | Attributt               | Gjeldende | Verste | Terskel |
| --- | ----------------------- | --------- | ------ | ------- |
| 1   | Raw_Read_Error_Rate     | 77        | 64     | 44      |
| 3   | Spin_Up_Time            | 94        | 93     | 0       |
| 4   | Start_Stop_Count        | 100       | 100    | 20      |
| 5   | Reallocated_Sector_Ct   | 100       | 100    | 10      |
| 7   | Seek_Error_Rate         | 73        | 60     | 45      |
| 9   | Power_On_Hours          | 100       | 100    | 0       |
| 10  | Spin_Retry_Count        | 100       | 100    | 97      |
| 12  | Power_Cycle_Count       | 100       | 100    | 20      |
| 18  | Unknown_Attribute       | 100       | 100    | 50      |
| 187 | Reported_Uncorrect      | 100       | 100    | 0       |
| 188 | Unknown_Attribute       | 100       | 100    | 0       |
| 190 | Airflow_Temperature_Cel | 62        | 56     | 0       |
| 192 | Power-Off_Retract_Count | 100       | 100    | 0       |
| 193 | Load_Cycle_Count        | 100       | 100    | 0       |
| 194 | Temperature_Celsius     | 38        | 44     | 0       |
| 197 | Current_Pending_Sector  | 100       | 100    | 0       |
| 198 | Offline_Uncorrectable   | 100       | 100    | 0       |
| 199 | UDMA_CRC_Error_Count    | 200       | 200    | 0       |
| 200 | Multi_Zone_Error_Rate   | 100       | 100    | 1       |
| 240 | Head_Flying_Hours       | 100       | 100    | 0       |
| 241 | Unknown_Attribute       | 100       | 253    | 0       |
| 242 | Unknown_Attribute       | 100       | 253    | 0       |

## DISK6
Før prestress-test [[ST12000NM000J-2TY103-ZRT1CT56-SMART_mht.txt]]


---

# Recovery 09.10.2024
## Status
Disk 2 død.
Alle filer kopiert med UserScript til LolbraaNAS.
3TB ledig av 8.91. RAID 5
[[FamBraaNAS Recovery 09.10.2024-20241009105709576.jpg]]

## 1. Velge ny disk
### Compability
- [Max disk size increase for EX4? - My Cloud EX4 - WD Community](https://community.wd.com/t/max-disk-size-increase-for-ex4/221458): EX4 cloud is designed to handle 4 different drive with max capacity of 10TB each on each bay.  Kanskje 12TB?
- [My Cloud Hard Drive Compatibility Matrix](https://support-en.wd.com/app/answers/detailweb/a_id/32083#subject5).
	- [Max Disk Capacity Per Bay - #5 by dnajarro76 - My Cloud EX4 - WD Community](https://community.wd.com/t/max-disk-capacity-per-bay/217215/5)
- **IMPORTANT:**
	- CMR and SMR drives are supported.
	- **My Cloud (Single Bay) cannot be serviced.**
	- **4Kn (native) sector drives are NOT supported.  
	    They MUST NOT be used..
	- **The drive must be replaced with the same model and capacity**.

### Ny disk
Pappa kjøpte 2stk [Seagate Exos X18 ST12000NM000J HDD 12TB - 3,5tm (SATA-600) - 2519 kr ｜Gratis Frakt](https://www.avxperten.no/harddisk/seagate-exos-x18-st12000nm000j-hdd-12tb-3-5tm-sata-600.asp) til 2519kr minus moms
- [[DATA SHEET exos x18.pdf]]
- [[manual-104425-19871593 X18 SAS Product Manual.pdf]]

|   |   |
|---|---|
|Egenskaper|   |
|Modell/Type|Harddisk|
|Komponent for|Diskmatrise|
|Intern harddisk (GB)|12000|
|HDD-størrelse (")|3.5|
|Uncorrectable Bit Error Rate (UBER)|< 1 per 10^15 bits read|
|Gjennomsnittstid mellom feil (MTBF) (timer)|2500000|
|HDD-hastighet (RPM)|7200|
|Lagringsenhetens bufferstørrelse (MB)|256|
|Vedvarende overføringshastighet HDD (MiB/s)|258|
|Gjennomsnittlig ventetid (ms)|4.16|
|Overføringshastighet HDD-grensesnitt (Gbit/s)|6|
|Rotasjonsvibreringssensorer (RV)|Ja|
|24/7-drift|Ja|
|Interface|Serial ATA III|
|Energihåndtering|   |
|Strømforbruk (lese) (W)|8.6|
|Strømforbruk (skrive) (W)|5.8|
|Strømforbruk (inaktiv) (W)|4.4|
|Driftsspenning (V)|5 / 12|
|Miljømessige forhold|   |
|Driftstemperatur (T-T) (°C)|5 - 60|
|Vibrering ved stillstand (G)|2.27|
|Støt under drift (G)|50|
|Sjokk ved ikke-drift (G)|200|

Fikk to disker, men de var kun pakket med bobleplast. Klaget og fikk nye.
1. Disk 1, ST12000NM000J-2TY103
	1. Merket: Okt. 2024 Disk 5 ZRT1EV1Y 
	2. SN: ZRT1EV1Y
	3. [[FamBraaNAS-20241023182517086.jpg|Bilde]]
	4. SMART-rapport ![[ST12000NM000J-2TY103-ZRT1EV1Y-SMART_mht.txt]]
3. Disk 2, ST12000NM000J-2TY103
	1. Merket: Okt. 2024 Disk 6 ZRT1CT56, [[FamBraaNAS-20241026- disk6.jpg]]
		1. Ligger i skyvedørsgarderoben i kjellersoverommet
	2. sn: ZRT1CT56
	3. [[FamBraaNAS-20241023183625857.jpg|Bilde]]
	4. SMART-rapport ![[ST12000NM000J-2TY103-ZRT1CT56-SMART_mht.txt]]



## 2. Validere diskene
Før vi tok dem i bruk, vil jeg validere at de faktisk fungerer og ikke er dead on arrival.
Kjørte:
1. [Windows based preclear  - General Support - Unraid](https://forums.unraid.net/topic/48145-windows-based-preclear/?do=findComment&comment=486136): WD's Data Lifeguard;  Seagate's SeaTools;  HGST's Drive Fitness Test
	1. Kjørte Seatools Long Generic Test. Start 23.10.2024: 1900, slutt
	2. Long Generic Test Passed, dagen etter 10:

3. [hard drive - Equivalent of badblocks on Windows or DOS - Super User](https://superuser.com/questions/338067/equivalent-of-badblocks-on-windows-or-dos)
	1. [Quick: Use badblocks to check  larger hard drives (8TB+)](https://davejansen.com/use-badblocks-to-check-larger-hard-drives/)

```Powershell
PS C:\WINDOWS\system32> wmic diskdrive list brief
Caption                 DeviceID            Model                   Partitions  Size
TOSHIBA Q300            \\.\PHYSICALDRIVE2  TOSHIBA Q300            1           120031511040
KINGSTON SV300S37A120G  \\.\PHYSICALDRIVE0  KINGSTON SV300S37A120G  3           120031511040
ST12000NM000J-2TY103    \\.\PHYSICALDRIVE4  ST12000NM000J-2TY103    0           12000132426240
ST1000DM003-1SB10C      \\.\PHYSICALDRIVE1  ST1000DM003-1SB10C      1           1000202273280
ST12000NM000J-2TY103    \\.\PHYSICALDRIVE3  ST12000NM000J-2TY103    0           12000132426240

PS C:\WINDOWS\system32> wsl --mount \\.\PHYSICALDRIVE3 --bare
>> wsl --mount \\.\PHYSICALDRIVE4 --bare
The operation completed successfully.
The operation completed successfully.

```

```SH
wsl@StigsStasjonre:~$ lsblk
NAME
    MAJ:MIN RM   SIZE RO TYPE MOUNTPOINTS
sda   8:0    0 388.5M  1 disk
sdb   8:16   0     1G  0 disk [SWAP]
sdc   8:32   0     1T  0 disk /mnt/wslg/distro
                              /
sdd   8:48   0  10.9T  0 disk
sde   8:64   0  10.9T  0 disk

wsl@StigsStasjonre:~$ sudo blockdev --getbsz /dev/sdd
4096

sudo badblocks -t random -w -s -b 4096 /dev/sdd
```
Badblocks fikk ikke kjørt seg ferdig; etter ca 36 timer skrudde maskina seg av. Aner ikke hvorfor. Ca 90% på begge, null errors. Friskmelder de.


## 3. Montere og rebuilde array, 26. oktober
- [Steps to Replace Internal Drives in a 2 and 4 Bay My Cloud](https://support-en.wd.com/app/answers/detailweb/a_id/15992#subject2)
- Tok ut den gamle disken (merket med rød led) og dyttet inn den nye.
- Etter et par minutter ble den gjenkjent i WebUI [[FamBraaNAS-20241026-OppdagetNyDisk.jpg]]
- 26.10.2024 19:38 prosessen med rebuilding startet [[FamBraaNAS-20241026-Rebuilding.jpg]]
- 27.10.2024 09:55 RAID-gjenoppretting fullført


---

# Overføre til ny NAS

Mountet FamBraaNAS på BraaNAS
- /mnt/remotes/192.168.1.65_Backup
	- backup
- 192.168.1.65_Fam_Braa
	- felles
- 192.168.1.65_Kristoffer
	- lolandbraa
- 192.168.1.65_Public
	- felles
```sh
rsync -axHWXSC --info=progress2 /mnt/remotes/192.168.1.65_Backup/ /mnt/user/backup --log-file=/mnt/user/appdata/.logs/flytting_backup.txt
```
1,173,119,067,052 100%   22.39MB/s   13:52:41 (xfr#10907, to-chk=0/13791)
```sh
rsync -axHWXSC --info=progress2 /mnt/remotes/192.168.1.65_Backup/ /mnt/user/backup --log-file=/mnt/user/appdata/.logs/flytting_backup_verifikasjon.txt
```


```sh
rsync -axHWXSC --info=progress2 /mnt/remotes/192.168.1.65_Fam_Braa/ /mnt/user/felles --log-file=/mnt/user/appdata/.logs/flytting_felles.txt
```
3,126,062,277,474 100%   19.88MB/s   41:39:02 (xfr#678747, to-chk=0/696118)
```sh
rsync -axHWXSC --info=progress2 /mnt/remotes/192.168.1.65_Fam_Braa/ /mnt/user/felles --log-file=/mnt/user/appdata/.logs/flytting_felles_verifikasjon.txt
```


```sh
rsync -axHWXSC --info=progress2 /mnt/remotes/192.168.1.65_Kristoffer/ /mnt/user/lolbraa --log-file=/mnt/user/appdata/.logs/flytting_Kristoffer.txt
```
403,335,863,242 100%   22.51MB/s    4:44:48 (xfr#1, to-chk=0/2)



# Fjerne duplikater
Brukte Czkawka på BraaNAS og sjekket hele Fotobanken for duplikate filer med BLAKE3-hashing.
1. Valgte alle filnavn med filteret "f*" og så valgte "case sensitive" og "Don't select all records in a  group". Fjerner da alle filer fra recovery av HDD som finnes fullstendig begge plasser.
	1. Fotobanken var ca. 2.9TiB på FamBraaNAS. NASen sier 2.9T, men rsync sier 2911GiB eller 3126GB
	2. Fotobanken er på ca. 1.55 TB etter sletting.
	3. Found 271753 duplicated files which in 92634 groups which takes 1.75 TiB.
	4. Slettet 

![[results_duplicates 1.txt]]